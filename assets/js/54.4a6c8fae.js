(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{370:function(a,t,s){a.exports=s.p+"assets/img/activemq_download_archives.846419e2.jpg"},371:function(a,t,s){a.exports=s.p+"assets/img/activemq_download_linux.089c93d1.jpg"},570:function(a,t,s){"use strict";s.r(t);var e=s(8),n=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"activemq安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#activemq安装"}},[a._v("#")]),a._v(" ActiveMQ安装")]),a._v(" "),t("h2",{attrs:{id:"activemq简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#activemq简介"}},[a._v("#")]),a._v(" ActiveMQ简介")]),a._v(" "),t("p",[a._v("ActiveMQ是Apache出品，流行的，能力强劲的开源消息总线，是完全支持JMS1.1和J2EE1.4规范的JMS Provider实现（JMS在当今的J2EE应用中仍然扮演者重要的角色）")]),a._v(" "),t("p",[a._v("熟悉JMS的API的使用，就能操作ActiveMQ")]),a._v(" "),t("h2",{attrs:{id:"activemq特性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#activemq特性"}},[a._v("#")]),a._v(" ActiveMQ特性")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("支持多种编程语言：不只是Java，C、Ruby、Php等都可以操作它")])]),a._v(" "),t("li",[t("p",[a._v("支持多种传输协议：JMS只是提供了API，具体发送数据的传输协议由ActiveMQ支持，ActiveMQ支持MQTT、AMQP、UDP、HTTP等协议")])]),a._v(" "),t("li",[t("p",[a._v("有多种持久化方式：可以文件，可以数据库")])]),a._v(" "),t("li",[t("p",[a._v("在传统业务中应用广泛")])])]),a._v(" "),t("h2",{attrs:{id:"安装activemq-安装环境基于centos7和jdk1-8"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装activemq-安装环境基于centos7和jdk1-8"}},[a._v("#")]),a._v(" 安装ActiveMQ（安装环境基于Centos7和Jdk1.8）")]),a._v(" "),t("blockquote",[t("p",[a._v("下载ActiveMQ")])]),a._v(" "),t("p",[a._v("通过浏览器打开网页https://activemq.apache.org/download-archives，寻找合适的ActiveMQ版本")]),a._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":s(370),loading:"lazy"}})]),a._v(" "),t("p",[a._v("获取所需ActiveMQ版本的下载链接")]),a._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":s(371),loading:"lazy"}})]),a._v(" "),t("p",[a._v("获取到链接（比如https://dlcdn.apache.org//activemq/5.15.8/apache-activemq-5.15.8-bin.tar.gz）后")]),a._v(" "),t("p",[a._v('进入提取准备好的activemq安装目录，并且使用wget下载存档，如果Linux系统没有wget需要先通过"yum install wget"命令安装wget')]),a._v(" "),t("p",[a._v("如果Linux服务器下载资源较慢，可以本地先下载好ActiveMQ存档，再上传到Linux服务器上")]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("wget -c https://archive.apache.org/dist/activemq/5.15.8/apache-activemq-5.15.8-bin.tar.gz\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("blockquote",[t("p",[a._v("安装ActiveMQ")])]),a._v(" "),t("p",[a._v("下载完毕后，到activemq下载目录，提取存档")]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("tar -zxvf apache-activemq-5.15.8-bin.tar.gz\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("修改activemq的目录名")]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("mv /data/software/apache-activemq-5.15.8 /data/software/activemq\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("移除存档")]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("rm -rf apache-activemq-5.15.8-bin.tar.gz\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h2",{attrs:{id:"启动activemq服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动activemq服务"}},[a._v("#")]),a._v(" 启动ActivemQ服务")]),a._v(" "),t("blockquote",[t("p",[a._v("使用命令启动ActiveMQ服务")])]),a._v(" "),t("p",[a._v("进入ActiveMQ目录，作为后台进程启动ActiveMQ")]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("# 进入ActiveMQ安装目录\ncd /data/software/activemq\n\n# 启动ActiveMQ\n./bin/activemq start\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("p",[a._v("如果后台进程启动成功，会有类似以下输出")]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("INFO: Loading '/data/software/activemq//bin/env'\nINFO: Using java '/data/software/jdk/jdk1.8.0_221/bin/java'\nINFO: Starting - inspect logfiles specified in logging.properties and log4j.properties to get details\nINFO: pidfile created : '/data/software/activemq//data/activemq.pid' (pid '1293236')\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("blockquote",[t("p",[a._v("使用命令停止ActiveMQ服务")])]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("# 进入ActiveMQ安装目录\ncd /data/software/activemq\n\n# 停止ActiveMQ服务\n./bin/activemq stop\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("p",[a._v("如果后台进程停止成功，会有类似以下输出")]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("INFO: Loading '/data/software/activemq//bin/env'\nINFO: Using java '/data/software/jdk/jdk1.8.0_221/bin/java'\nERROR: No or outdated process id in '/data/software/activemq//data/activemq.pid'\nINFO: Removing /data/software/activemq//data/activemq.pid\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("blockquote",[t("p",[a._v("使用System服务启动ActiveMQ服务")])]),a._v(" "),t("p",[a._v("前面使用命令运行ActiveMQ，但有时候在工作环境中，不是使用这种方式启动服务（降低运维成本，因为不同的中间件有不同的启动命令，\n如果是系统服务的话启动命令就比较统一了，不管是老的运维还是新来的运维，对他们来说，操作手册都是统一的），最好的方式是将ActiveMQ作为服务启动，\n使用System服务将可以确保ActiveMQ能在系统启动时自行启动\n统一：不用管ActiveMQ安装目录在哪里，也不用管命令是什么")]),a._v(" "),t("ul",[t("li",[a._v("使用vim创建一个systemd服务文件")])]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vi /usr/lib/systemd/system/activemq.service\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("ul",[t("li",[a._v("填写类似以下内容\n作用是记录启动、停止命令、日志输出")])]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[Unit]\nDescription=ActiveMQ service\nAfter=network.target\n\n[Service]\nType=forking\nExecStart=/data/software/activemq/bin/activemq start\nExecStop=/data/software/activemq/bin/activemq stop\nUser=root\nGroup=root\nRestart=always\nRestartSec=9\nStandardOutput=syslog\nStandardError=syslog\nSyslogIdentifier=activemq\n\n[install]\nWantedBy=multi-user.target\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br")])]),t("p",[a._v("系统日志一般都在/var/log/message里面")]),a._v(" "),t("ul",[t("li",[a._v("修改activemq配置，将JAVA_HOME的注释取消，填入jdk安装路径（填入自己机器的jdk安装路径），设JAVA_HOME，告知jdk目录在哪里")])]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('vi /data/software/activemq/bin/env\n\n找到\n# Location of the java installation\n# Specify the location of your java installation using JAVA_HOME, or specify the\n# path to the "java" binary using JAVACMD\n# (set JAVACMD to "auto" for automatic detection)\n#JAVA_HOME=""\nJAVACMD="auto"\n\n将其改为\n# Location of the java installation\n# Specify the location of your java installation using JAVA_HOME, or specify the\n# path to the "java" binary using JAVACMD\n# (set JAVACMD to "auto" for automatic detection)\nJAVA_HOME="/data/software/jdk/jdk1.8.0_221"\nJAVACMD="auto"\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br")])]),t("p",[a._v("经过一系列操作，ActiveMQ系统服务就创建好了（JAVA_HOME目录配置好才能正常启动）")]),a._v(" "),t("ul",[t("li",[a._v("启动ActiveMQ服务")])]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("systemctl start activemq\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("ul",[t("li",[a._v("查看服务状态")])]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("systemctl status activemq\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("ul",[t("li",[a._v("设置开机自动启动")])]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("\n# 第一步\nln -s /usr/lib/systemd/system/activemq.service /etc/systemd/system/multi-user.target.wants/activemq.service\n\n# 第二步\nsystemctl enable activemq\n\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br")])]),t("ul",[t("li",[a._v("防火墙添加ActiveMQ的端口\n如果ActiveMQ启动后，外部还无法访问，还需要在防火墙配置中添加ActiveMQ的Web管理端口和通讯端口")])]),a._v(" "),t("p",[a._v("添加端口")]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("# Web管理端口默认为8161，通讯端口默认为61616\nfirewall-cmd --zone=public --add-port=8161/tcp --permanent\nfirewall-cmd --zone=public --add-port=61616/tcp --permanent\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("p",[a._v("重启防火墙")]),a._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("systemctl restart firewalld.service\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);